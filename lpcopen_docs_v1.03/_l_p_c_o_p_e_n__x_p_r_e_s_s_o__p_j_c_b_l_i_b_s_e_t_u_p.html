<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LPCOpen Platform: Setting up an Xpresso library project for Chip and Board drivers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="driver.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">LPCOpen Platform
   &#160;<span id="projectnumber">v1.03</span>
   </div>
   <div id="projectbrief">LPCOpen Platform for NXP LPC Microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_l_p_c_o_p_e_n__x_p_r_e_s_s_o__p_j_c_b_l_i_b_s_e_t_u_p.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Setting up an Xpresso library project for Chip and Board drivers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Setting up an Xpresso project</b><br/>
 A board library project contains the Chip and Board layer code that will be built into a library and used in other projects.<br/>
</p>
<p><b><em>The example here shows how to build the board library for the Embedded Artists LCP1788 board. This library includes the IP, Chip, and Board layers.</em></b><br/>
</p>
<p><b>Create a new library project</b><br/>
 Create a new project using the New-&gt;Project selection on the file menu.<br/>
 </p>
<div class="image">
<img src="new_project1.jpg" alt="new_project1.jpg"/>
</div>
<p>Select C/C++-&gt;C project in the new project dialog window and press Next&gt;.<br/>
 </p>
<div class="image">
<img src="new_project2.jpg" alt="new_project2.jpg"/>
</div>
<p>On the next dialog window, name your library project and select the static library project type. Press Next&gt;.<br/>
 </p>
<div class="image">
<img src="new_project3.jpg" alt="new_project3.jpg"/>
</div>
<p>On the next dialog window, select the default 'Debug' and 'Release' project configurations. This will create an unoptimized debug configuration and an optimized release configuration of the project. Press Next&gt;.<br/>
</p>
<p>On the next dialog window, select the device your project will use. <em>For this example, we use the LPC1788.</em>. Press Finish.<br/>
 </p>
<div class="image">
<img src="new_project4.jpg" alt="new_project4.jpg"/>
</div>
<p>After pressing Finish, the project is added to the project explorer window. Before adding source files to the project, a few more items specific to the LPCOpen platform need to be configured in the project.<br/>
</p>
<p><b>CORE_M? symbol setup</b><br/>
 Although all of the default project settings should work fine, the LPCOpen platform code requires a few additional configuration steps.<br/>
</p>
<p>Right click on the project in the Project explorer and select Properties from the popup menu. This will being up the project properties dialog window.<br/>
</p>
<p>From the category list on the left side of the dialog window, select the C/C++ Build option. In the right half of the window, notice that the project contains 2 configurations - Debug and Release. The additional steps indicated below must be applied to both configurations separately. To switch configurations, just select the configuration in the Configuration drop down box.<br/>
 </p>
<div class="image">
<img src="project_settings1.jpg" alt="project_settings1.jpg"/>
</div>
<p>Select the C/C++ Build-&gt;Settings option in the category window and the MCU C Compiler-&gt;Symbols option in the Tool Settings tab in the right window. For the device you are using, you will need to add a new symbol here of value CORE_M0, CORE_M0PLUS, CORE_M3, or CORE_M4. To add this new symbol, click the green + button and type in the name of the symbol and press OK. A list of CORE_M? values to use for each device can be found at one of the links below based on your selected device family.<br/>
 <a class="el" href="group___c_h_i_p__8_x_x___d_r_i_v_e_r___o_p_t_i_o_n_s.html">CHIP: LPC8xx Chip driver build time options</a><br/>
 <a class="el" href="group___c_h_i_p__11_x_x___d_r_i_v_e_r___o_p_t_i_o_n_s.html">CHIP: LPC11xx Chip driver build time options</a><br/>
 <a class="el" href="group___c_h_i_p__13_x_x___d_r_i_v_e_r___o_p_t_i_o_n_s.html">CHIP: LPC13xx Chip driver build time options</a><br/>
 <a class="el" href="group___c_h_i_p__17_x_x__40_x_x___d_r_i_v_e_r___o_p_t_i_o_n_s.html">CHIP: LPC17xx/40xx Chip driver build time options</a><br/>
 <a class="el" href="group___c_h_i_p__18_x_x__43_x_x___d_r_i_v_e_r___o_p_t_i_o_n_s.html">CHIP: LPC18xx/43xx Chip driver build time options</a><br/>
 The example screen below uses CORE_M3 for the LCP1788 device. Do this for both Debug and Release configurations.<br/>
 </p>
<div class="image">
<img src="project_settings2.jpg" alt="project_settings2.jpg"/>
</div>
<p><b>sys_config.h symbols</b><br/>
 If a symbol needed for building a platform isn't included in sys_config.h (see <a class="el" href="_s_y_s_c_o_n_f_i_g__d_e_f__a_d_d.html">Adding platform definitions using sys_config.h</a>), then is must also be added in the symbol list similar to the CORE_M value.<br/>
</p>
<p><b>Xpresso run-time library selection</b><br/>
 Most LPCOpen projects run with the Redlib(none) or Redlib(nohost) libraries. These are the recommended libraries to use when building LPCOpen. For best size, use the (none) version of the library. If you plan on using standard I/O (printf), use the (nohost) version of the library. <em>If you use the DEBUG_ENABLE option (see <a class="el" href="_s_y_s_c_o_n_f_i_g__d_e_f__a_d_d.html">Adding platform definitions using sys_config.h</a>), then use the (nohost) option.</em> The library type can be selected on the quickstart panel.<br/>
 </p>
<div class="image">
<img src="proj_sel_libtype.jpg" alt="proj_sel_libtype.jpg"/>
</div>
<p><b>Adding source files</b><br/>
 Now that the project has been setup, source files can be added to the project. Multiple source files may need to be added from multiple directories.<br/>
</p>
<p>The example procedure below shows the files needed to build the Embedded Artists LPC1788 board library.<br/>
</p>
<ul>
<li>Select files from the IP layer as needed by the LPC1788 device<br/>
</li>
<li>Select all files from the LPC17xx/40xx Chip layer<br/>
</li>
<li>Select all files from the Chip common code area<br/>
</li>
<li>Select all files from the EA1788/40xx board layer<br/>
</li>
<li>Select sys_config.h from the EA1788 board layer (specific to the EA1788 board)<br/>
</li>
</ul>
<p>Files are added to the Xpresso project in groups. The IP layer, Chip layer, and Board layer files each needed to be added in a separate dialog. A complete list of files to add specific to a chip or board can be found at <a class="el" href="_l_p_c_o_p_e_n__c_h_i_p__c_o_r_e.html">Files required for Chip layer</a>.<br/>
</p>
<p>To add IP layer source files to the project, right click on the project in the project xplorer window and select import. Select the general-&gt;File System and press Next&gt;.<br/>
 </p>
<div class="image">
<img src="project_file_import1.jpg" alt="project_file_import1.jpg"/>
</div>
<p>Browse to the "lpc_ip" directory and a selection of files will appear in the file view below the directory box. Only check the files that apply to the device family you are using. A full IP layer file list associated with each device family can be found at <a class="el" href="_l_p_c_o_p_e_n__i_p__d_r_i_v_e_r__r_e_q_s.html">IP drivers required for Chip layer code</a>. Press Finish when all the files have been selected.<br/>
 <em>In the image below, the IP layer files for the LPC1788 device are selected.</em><br/>
 </p>
<div class="image">
<img src="project_file_import2.jpg" alt="project_file_import2.jpg"/>
</div>
<p>The import procedure needs to be repeated for the Chip layer, Chip common, and Board layer files. <em>In the images below, the Chip and Board layer files for the LPC1788 device and EA1788 board are added.</em><br/>
 "&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_chip\chip_17xx_40xx".<br/>
 </p>
<div class="image">
<img src="project_file_import3.jpg" alt="project_file_import3.jpg"/>
</div>
<p>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_chip\chip_common".<br/>
 </p>
<div class="image">
<img src="project_file_import4.jpg" alt="project_file_import4.jpg"/>
</div>
<p>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_board\boards_17xx_40xx\ea_devkit_17884088".<br/>
 </p>
<div class="image">
<img src="project_file_import5.jpg" alt="project_file_import5.jpg"/>
</div>
<p><b>What about common board code? Do I need to add it to the project?</b><br/>
 Common board source code files (files in the "&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_board\board_common" directory) do not need to be added to the project, although this directory needs to be added as an include path. When a board file is neede by a platform, the source code for that Board later will include the necessary common board source files as part of it's source code.<br/>
</p>
<p><b>Adding include paths</b><br/>
 To add include paths to the project, right click on the project in the project explorer window and select properties. Select the C/C++ Build-&gt;Settings option in the category window and the MCU C Compiler-&gt;Includes option in the Tool Settings tab in the right window. Add include paths one at a time to the project by pressing the green + symbol. Be sure to do this for both Debug and Release configurations. Once all the include paths have been added, press OK to return to the workspace view.<br/>
 For the EA1788 board project, the following include paths are needed:<br/>
</p>
<ul>
<li>"&lt;LPCOPEN_PATH&gt;\software\CMSIS\CMSIS\Include"<br/>
</li>
<li>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_ip"<br/>
</li>
<li>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_chip\chip_common"<br/>
</li>
<li>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_chip\chip_lpc17xx_40xx"<br/>
</li>
<li>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_boards\board_common"<br/>
</li>
<li>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_boards\boards_17xx_40xx\ea_devkit_17884088"<br/>
</li>
<li>"&lt;LPCOPEN_PATH&gt;\software\lpc_core\lpc_boards\boards_17xx_40xx\ea_devkit_17884088\ea_devkit_1788" (for EA1788 sys_config.h only)<br/>
 Include paths needed for the Chip and Board layers for a device family can be found at <a class="el" href="_l_p_c_o_p_e_n__p_r_o_j_e_c_t__l_i_b_l_i_s_t.html">LPCOpen library configurations</a>.<br/>
 <div class="image">
<img src="project_include1.jpg" alt="project_include1.jpg"/>
</div>
</li>
</ul>
<p>At this point, the library project is complete. You can build test the debug and release configurations of your project now.<br/>
 </p>
<pre class="fragment">Building target: libboard_lib_1788.a
Invoking: MCU Archiver
arm-none-eabi-ar -r  "libboard_lib_1788.a"  ./adc_001.o ./adc_17xx_40xx.o ./board_ea_devkit_17884088.o ./can_001.o ./can_17xx_40xx.o ./clock_17xx_40xx.o ./cmp_17xx_40xx.o ./crc_001.o ./crc_17xx_40xx.o ./dac_001.o ./dac_17xx_40xx.o ./eeprom_001.o ./eeprom_17xx_40xx.o ./emc_17xx_40xx.o ./enet_002.o ./enet_17xx_40xx.o ./gpdma_001.o ./gpdma_17xx_40xx.o ./i2c_001.o ./i2c_17xx_40xx.o ./i2s_001.o ./i2s_17xx_40xx.o ./iocon_17xx_40xx.o ./lcd_001.o ./lcd_17xx_40xx.o ./mem_tests.o ./ring_buffer.o ./ritimer_17xx_40xx.o ./rtc_001.o ./rtc_17xx_40xx.o ./sdc_001.o ./sdc_17xx_40xx.o ./sdmmc_17xx_40xx.o ./spi_17xx_40xx.o ./ssp_001.o ./ssp_17xx_40xx.o ./sysctl_17xx_40xx.o ./sysinit_ea_devkit_17884088.o ./timer_001.o ./timer_17xx_40xx.o ./uart_17xx_40xx.o ./usart_001.o ./wwdt_001.o ./wwdt_17xx_40xx.o   
c:\nxp\LPCXpresso_5.2.4_2122\lpcxpresso\tools\bin\arm-none-eabi-ar.exe: creating libboard_lib_1788.a
Finished building target: libboard_lib_1788.a
 
make --no-print-directory post-build
Performing post-build steps
arm-none-eabi-size "libboard_lib_1788.a" ; # arm-none-eabi-objdump -h -S "libboard_lib_1788.a" &gt;"libboard_lib_1788.lss"
   text    data     bss     dec     hex filename
    660       0       0     660     294 adc_001.o (ex libboard_lib_1788.a)
    428       0       0     428     1ac adc_17xx_40xx.o (ex libboard_lib_1788.a)
   8772      16      18    8806    2266 board_ea_devkit_17884088.o (ex libboard_lib_1788.a)
   9492       0       0    9492    2514 can_001.o (ex libboard_lib_1788.a)
    612       0       0     612     264 can_17xx_40xx.o (ex libboard_lib_1788.a)
   1848       0       0    1848     738 clock_17xx_40xx.o (ex libboard_lib_1788.a)
      0       0       0       0       0 cmp_17xx_40xx.o (ex libboard_lib_1788.a)
    400       0       0     400     190 crc_001.o (ex libboard_lib_1788.a)
    180       0       0     180      b4 crc_17xx_40xx.o (ex libboard_lib_1788.a)
    216       0       0     216      d8 dac_001.o (ex libboard_lib_1788.a)
     32       0       0      32      20 dac_17xx_40xx.o (ex libboard_lib_1788.a)
   1168       0       0    1168     490 eeprom_001.o (ex libboard_lib_1788.a)
    264       0       0     264     108 eeprom_17xx_40xx.o (ex libboard_lib_1788.a)
    132       0       0     132      84 emc_17xx_40xx.o (ex libboard_lib_1788.a)
   1016       0       4    1020     3fc enet_002.o (ex libboard_lib_1788.a)
    248       0       0     248      f8 enet_17xx_40xx.o (ex libboard_lib_1788.a)
    988       0       0     988     3dc gpdma_001.o (ex libboard_lib_1788.a)
   1740     128       8    1876     754 gpdma_17xx_40xx.o (ex libboard_lib_1788.a)
   1748       0       0    1748     6d4 i2c_001.o (ex libboard_lib_1788.a)
   2344      84     120    2548     9f4 i2c_17xx_40xx.o (ex libboard_lib_1788.a)
   1504       0       0    1504     5e0 i2s_001.o (ex libboard_lib_1788.a)
    928       0       0     928     3a0 i2s_17xx_40xx.o (ex libboard_lib_1788.a)
      0       0       0       0       0 iocon_17xx_40xx.o (ex libboard_lib_1788.a)
    608       0       0     608     260 lcd_001.o (ex libboard_lib_1788.a)
    640       1       0     641     281 lcd_17xx_40xx.o (ex libboard_lib_1788.a)
   1232       0       0    1232     4d0 mem_tests.o (ex libboard_lib_1788.a)
   1120       0       0    1120     460 ring_buffer.o (ex libboard_lib_1788.a)
      0       0       0       0       0 ritimer_17xx_40xx.o (ex libboard_lib_1788.a)
   1264       0       0    1264     4f0 rtc_001.o (ex libboard_lib_1788.a)
     92       0       0      92      5c rtc_17xx_40xx.o (ex libboard_lib_1788.a)
    820       0       0     820     334 sdc_001.o (ex libboard_lib_1788.a)
    292       0       0     292     124 sdc_17xx_40xx.o (ex libboard_lib_1788.a)
   5760       0       0    5760    1680 sdmmc_17xx_40xx.o (ex libboard_lib_1788.a)
      0       0       0       0       0 spi_17xx_40xx.o (ex libboard_lib_1788.a)
     60       0       0      60      3c ssp_001.o (ex libboard_lib_1788.a)
   2468       0       0    2468     9a4 ssp_17xx_40xx.o (ex libboard_lib_1788.a)
    192       0       0     192      c0 sysctl_17xx_40xx.o (ex libboard_lib_1788.a)
   1272       0       0    1272     4f8 sysinit_ea_devkit_17884088.o (ex libboard_lib_1788.a)
    168       0       0     168      a8 timer_001.o (ex libboard_lib_1788.a)
    160       0       0     160      a0 timer_17xx_40xx.o (ex libboard_lib_1788.a)
   2072       0     530    2602     a2a uart_17xx_40xx.o (ex libboard_lib_1788.a)
   2060       0       0    2060     80c usart_001.o (ex libboard_lib_1788.a)
    116       0       0     116      74 wwdt_001.o (ex libboard_lib_1788.a)
     24       0       0      24      18 wwdt_17xx_40xx.o (ex libboard_lib_1788.a)
 

15:14:52 Build Finished (took 33s.883ms)
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">LPCOpen Platform for NXP LPC Microcontrollers</a></li><li class="navelem"><a class="el" href="_l_p_c_o_p_e_n__t_e_c_h_l_i_b.html">LPCOpen technical library</a></li><li class="navelem"><a class="el" href="_l_p_c_o_p_e_n__x_p_r_e_s_s_o__p_r_o_j_e_c_t__p_o_r_t_i_n_g__g_u_i_d_e.html">Xpresso: Creating new LPC Xpresso projects</a></li>
    <li class="footer">Generated on Fri May 10 2013 10:42:53 for LPCOpen Platform by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
